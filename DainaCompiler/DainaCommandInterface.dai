[DainaCommandInterface : [Object]] (DainaStatusReporter, InputStream, InputStream, OutputStream, SystemInputOutput,
									String, Variable, ControlFlow, DainaCommand, Boolean)
	[InputStream] commandInputStream
	[DainaStatusReporter] dainaStatusReporter
{

	~ newDainaCommandInterface *() {
		\::new;
		.commandInputStream = commandInputStream;
		.dainaStatusReporter = \[DainaStatusReporter]:statusReporterWithOutputStreamToReceiveStatus statusOutputStream;
	} !{
			[InputStream] commandInputStream = \[SystemInputOutput]:stdinInputStream;
			[OutputStream] statusOutputStream = \[SystemInputOutput]:stdoutOutputStream;
		}


	++ receiveCommandsFromUserUntilExitCommandIsReceivedWithCommandReceiver *([[DainaCommand]->] receiveCommand) {
		\.dainaStatusReporter:reportStatusThatDainaCommandReceiverIsNowReceivingCommands;
		\[ControlFlow]:repeatUntilStopped receiveCommandsAndStopWhenExitCommandIsReceived
		!{
			[[->]->] receiveCommandsAndStopWhenExitCommandIsReceived = *([->] stopReceivingCommands) {
				[String] parsedCommand = \:getNextCommandStringInput;
				\parsedCommandIsExit:ifTrue stopReceivingCommands;
				\parsedCommandIsParseDainaSourceFile:ifTrue *{
					\receiveCommand (\[DainaCommand]:commandToParseDainaSourceFile (\:getNextCommandStringInput))};
				\parsedCommandIsAnalyseAndSynthesiseSyntaxTree:ifTrue *{
					\receiveCommand (\[DainaCommand]:commandToAnalyseAndSynthesiseSyntaxTree)};
				\parsedCommandIsCompileToJavaInDirectory:ifTrue *{
					\receiveCommand (\[DainaCommand]:commandToCompileToJavaInDirectory (\:getNextCommandStringInput))};
				\parsedCommandIsCompileToCInDirectory:ifTrue *{
					\receiveCommand (\[DainaCommand]:commandToCompileToCInDirectory (\:getNextCommandStringInput))};
				\parsedCommandIsInvalid:ifTrue *{
					\.dainaStatusReporter:reportStatusInvalidCommand};
			}	!{
					[Boolean] parsedCommandIsExit = \parsedCommand:isEqualTo \[DainaCommand]:exitCommandString;
					[Boolean] parsedCommandIsParseDainaSourceFile = \parsedCommand:isEqualTo \[DainaCommand]:parseDainaSourceFileCommandString;
					[Boolean] parsedCommandIsAnalyseAndSynthesiseSyntaxTree = \parsedCommand:isEqualTo \[DainaCommand]:parsedCommandIsAnalyseAndSynthesiseSyntaxTree;
					[Boolean] parsedCommandIsCompileToJavaInDirectory = \parsedCommand:isEqualTo \[DainaCommand]:compileToJavaInDirectoryCommandString;
					[Boolean] parsedCommandIsCompileToJavaInDirectory = \parsedCommand:isEqualTo \[DainaCommand]:compileToJavaInDirectoryCommandString;
				}
		};
		\.dainaStatusReporter:reportStatusThatDainaCommandReceiverIsStoppingSinceExitCommandWasReceived	
	}

	- getNextCommandStringInput *()->[String] {} -> \.commandInputStream:parseDataAsStringUntilNewline

	++ provideDainaStatusReporter *-> .dainaStatusReporter
}

